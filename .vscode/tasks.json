{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Build",
      "type": "shell",
      "command": "set -o pipefail; rm -rf \"${workspaceFolder}/DerivedData/${config:scheme}.xcresult\"; xcodebuild build -scheme ${config:scheme} -configuration Debug -destination \"platform=macOS,arch=arm64\" -derivedDataPath \"${workspaceFolder}/DerivedData\" -resultBundlePath \"${workspaceFolder}/DerivedData/${config:scheme}.xcresult\" | xcbeautify  --disable-logging",
      "problemMatcher": [
        {
          "fileLocation": ["absolute"],
          "pattern": {
            "regexp": "^(?:❌|\\[x\\])\\s*(\\/[^:]+):(\\d+):(\\d+):\\s*(.*)$",
            "file": 1,
            "line": 2,
            "column": 3,
            "message": 4
          },
          "severity": "error"
        },
        {
          "fileLocation": ["absolute"],
          "pattern": {
            "regexp": "^(?:⚠️|\\[!\\])\\s*(\\/[^:]+):(\\d+):(\\d+):\\s*(.*)$",
            "file": 1,
            "line": 2,
            "column": 3,
            "message": 4
          },
          "severity": "warning"
        }
      ],
      "group": { "kind": "build", "isDefault": true },
      "presentation": {
        "panel": "dedicated",
        "echo": false,
        "showReuseMessage": false
      }
    },
    {
      "label": "Log Stream",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/log_formatter.sh ${workspaceFolder}/DerivedData/Build/Products/Debug/${config:appName}.app/Contents/MacOS/${config:appName} ${config:bundleID}",
      "problemMatcher": [],
      "isBackground": true,
      "presentation": {
        "panel": "dedicated",
        "echo": false,
        "showReuseMessage": false
      }
    },
    {
      "label": "Delete Derived Data",
      "type": "shell",
      "command": "rm -rf ${workspaceFolder}/DerivedData",
      "problemMatcher": [],
      "presentation": { "close": true }
    },
    {
      "label": "Reset Permissions",
      "type": "shell",
      "command": "tccutil reset All ${config:bundleID}",
      "problemMatcher": [],
      "presentation": { "close": true }
    },
    {
      "label": "Reset Defaults",
      "type": "shell",
      "command": "defaults delete ${config:bundleID}",
      "problemMatcher": [],
      "presentation": { "close": true }
    },
    {
      "label": "Release",
      "type": "shell",
      "command": "${workspaceFolder}/Scripts/release.sh",
      "problemMatcher": [],
      "presentation": { "echo": false, "showReuseMessage": false }
    }
  ]
}
